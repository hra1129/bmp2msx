BMP to MSX
							(C)2000-2022 HRA!

2000/05/06	製作開始。GUI部分完成。減色、誤差拡散、縮小機能の実装。
			設定ダイアログ実装。パレット編集機能。各種モード選択機能実装。
			バージョン表示ダイアログ実装。
	 05/07	ディスク保存機能。ドラッグ＆ドロップ読み出し機能実装。
			誤差拡散ルーチンのバグ修正。経過表示ダイアログ実装。
			自然画モード（SCREEN12）コンバータ実装。
			メニュー「Open」の機能を実装。メモリリークのバグ修正。
	 05/08	減色（１６色の選出）ルーチンのバグを修正。
	 		SCREEN5/7 のパレットテーブル出力に関するバグを修正。
	 		v0.9βとして公開。
	 05/11	減色ルーチン近似色算出用２色間距離算出方法の改善。
			自動パレット生成用色比較ルーチンの改善。
			自然画専用減色ルーチンの変換式を改善。
	 		コマンドライン引数を受け取る機能を実装。
			画面の表示を変更。
			自然画専用減色ルーチンのＲＧＢ係数を調節。
			デフォルト設定を変更。
	 05/12	自動パレット生成ルーチンに分散選色（！？）機能を追加。
			分散選色・多分布選色（昨日までのもの）を選択するチェックボックスを追加。
			デフォルト設定を若干変更。
	 05/13	縮小ルーチンを拡大縮小ルーチンに変更。
			サイズ調節チェックボックスを追加。
			デフォルトではサイズ調節しないように変更。
			サイズ調節しないルーチンを追加。
			SC5/8/12 インターレース専用サイズ調節無し（左右１／２サイズ）ルーチンを追加。
			設定の保存・読み込み機能を追加。
			デフォルト設定へ戻す機能を追加。
	 06/03	パレット出力モード選択を追加。
			ﾌｧｲﾙ保存時の種類指定を若干修正。
	 06/04	パレット出力モードのデフォルト設定が抜けていたバグを修正。
			PL? 形式のパレットファイルを読み込めるように修正。
			デフォルト設定を読み込んでも画面表示が更新されなかったバグを修正。
			切り捨て誤差のデフォルト値を 0 に変更。
	 06/21	SCREEN 12 の原色ルーチンの式を改善してみました。ついでに、整数演算だけにしたので
			若干速くなってるかもしれない。
			SCREEN10出力機能を実装（動作未確認）。
			輝度に対して誤差拡散機能を実装。
			なんか縦縞が出る場合がある・・・バグ？ (^_^;
	 06/22	SCREEN10出力がおかしかったバグを修正。
			設定ダイアログのデザインを若干変更。
			無関係の設定は無効（エンボス表示）にするようにした。
			ファイル名自動決定オプションを追加。
	 06/23	自然画の誤差拡散で斬り捨て誤差設定が反映されるように修正。
			自然画出力で、アルゴリズムを選択できる機能を追加。
	 06/24	自然画のＹＪＫ算出で使用している固定小数点の小数点以下を切り捨てずに考慮するように変更。
			誤差訂正ディザのディザ出力がおかしかったバグを修正。
			青・色差から計算するアルゴリズムを追加。
			パワフル活用法方式を追加。
			各アルゴリズムの計算式を微調整。
	 06/25	パレットのヒストグラム作成方法をソート＆カウントからハッシュ表に変更して高速化。
			最小化ボタンを追加。
			ハッシュ表を単純な５１２色カウント表に変更してさらなる高速化。
	 06/28	自然画生成の時に誤差拡散を利用すると明るい部分の表示がおかしくなるバグを修正。
			自動生成されるファイル名の拡張子を若干変更。
			エラー訂正アルゴリズムの選択機能を追加。
	 06/29	エラー訂正アルゴリズムをディザリングと誤差拡散に分離。
			ディザリングと誤差拡散の併用が可能になった。
			自然画生成時の誤差拡散をＹ値誤差拡散からＲＧＢ値誤差拡散に変更。
			プレビュー機能実装のための準備を開始。
	 07/01	プレビューの機能を実装。
			ショートカットキーの実装。
			再変換（再変換前を削除）の機能を実装。
			再変換（再変換前を削除しない）のメニューと機能を実装。
			複数ファイルをドロップしたときに変換直後にプレビュー画面が表示されるように修正。
			若干、プログラムを修正（機能に影響しないように拡張性を増強）
			インターレースモードでもちらつきが目立たないディザパターン「縦長タイル」を追加。
	 07/02	プレビュー表示で下端・右端が若干欠けているバグを修正。
			パレット決定アルゴリズムを一新、１６色固定から任意色（２〜１６色）へ対応可能に。
			使用可能・不可能なパレットを設定する機能を追加（使用無許可チェック、許可状態反転）。
			縦長タイルがインターレースモードであまり効果がないことに気が付き名前を修正 (^_^;
			プレビューの保存機能で、SCREEN5/7 の画像を正常に保存できなかったバグを修正。
			サイズ調整機能で入力と出力が同じサイズの場合はなにもしないように変更。
			ｸﾘｯﾌﾟﾎﾞｰﾄﾞから張り付ける機能を追加。
	 07/03	出力サイズと完全に同じサイズの画像を「サイズ調節ON」で変換すると正常に変換されない
			バグを修正。
			サイズ調節機能を若干高速化。
			BI_BITFIELDS 形式の 16/32bit ＢＭＰファイル/クリップボード画像の読み込みに対応（IE5保存形式）
			減色処理で誤差拡散のチェックをはずした状態でも誤差拡散がかかる場合があるバグを修正。
			ファイルから作成したプレビューも再変換できないバグを修正。
			誤差拡散係数の設定で必要以上に大きな値（誤差が膨張する）を指定できないように修正。
			自然画生成のアルゴリズムをいくつか追加。
	 07/04	プレビューに”名前を付けて保存”を追加。
			自然画生成のアルゴリズム「R･G･B･色差から再変換」を削除。
			変換元の画像を記憶して、変換結果と切り替えて表示できる機能を追加。
			２種類あった再変換機能を１つに統一。
			設定と再変換で表示されるダイアログのタイトルを、それぞれ「設定」「再変換」に変更。
			設定概要を画面に表示する機能を追加。
			変換後にメインウィンドウへフォーカスが移動する機能を追加。
			ウィンドウクリック時、プレビューがあるときは「再変換」、ないときは「設定」が起動するように変更。
	 07/05	長くなってきた WndProc.cpp をいくつかのソースに分割。
			プレビューからパレットファイル（*.PL5/*.PL7/*.CSV）作成の再変換・保存をすると正しくないパレット
			ファイルを作成することがあったバグを修正。
			必ず終了時に保存していたのを、変更があったときのみ保存するように修正。
	 07/08	画像の管理方法を若干変更。オリジナルのファイルイメージを記憶する機能を追加。
			オリジナル画像を表示する機能を追加。
			非対応の形式を読み込むとページ違反を起こしていたバグを修正。
			設定ファイルの拡張子を B2M へ変更。
			設定ファイルの保存・読み込み機能を追加。
			精度を指定する機能を追加。
			ディザを１つ追加。
			ディザパターンの合成方法（ディザ加算方法）を選択する機能を追加（自然画モードでは無効）。
			「0番」の色を使用しない設定を追加。
			精度設定機能追加により発生したメモリ関連のバグを修正。
			「設定の表示」を ON にしているときに設定を変更しても、すぐに画面に反映されないバグを修正。
			変換結果画像と変換元画像で「設定の表示」の背景色を変える機能を追加。
	 07/09	パレット個別に「固定パレット」を指定できる機能を追加。
			設定画面のパレット表示エリアに横線で固定パレットを示す機能を追加。
			オリジナル画像表示ウィンドウにスポイト機能を追加。
			強制ゼロ化を追加。
			メニューの使用不能な項目はグレイ表示になるように修正。
	 07/10	幅が４バイトの倍数でない画像を読み込んだ場合、画像が歪んでしまうバグを修正。
			1bit BMP,4bit BMP ファイルに対応。
	 07/11	パレットファイルを読み込んでも、即座にパレット表示領域が更新されないバグを修正。
	 07/12	プレビューを作成していないときもオリジナル画像を記憶してしまうバグを修正。
	 07/14	画像を内部で上下逆さまに処理していたのを、正しい向きに修正（将来の拡張のため）。
			誤差拡散の計算で、誤差の範囲外丸め処理を極力抑えるように修正。
	 07/15	"50%:50%の網タイル" 設定を追加。
			パレット決定ルーチンの中の 256階調→8階調変換処理を他と同じ（誤差少）に変更。
			SCREN10/12の誤差訂正アルゴリズムの範囲外丸め処理を削除。
			若干、自然画モードの数値（誤差訂正アルゴリズム、ディザ）を調整。
	 07/16	1bit/4bit のBMPファイル・クリップボード画像が正しく読めなくなっていたバグを修正。
			オリジナル画像表示で正しく表示されないことがあるバグを修正。
			自然画モードで強制ゼロ化をチェックしていなくても強制ゼロ化が適用されていたバグを修正。
			誤差拡散係数を小数点以下３桁まで指定できるように変更。
			"50%:50%の網タイル" 機能を実装。
			ディザパターンの名称を若干変更。
			設定表示に、50%:50%の網タイルを追加。
	 07/17	SC5/7/8 の"誤差拡散"と"50%:50%の網タイル"を使用すると、誤差拡散が正常に働かないバグを
			修正。
			ディザパターン（ハーフトーン）を追加。
	 07/18	SC8 の "誤差拡散"と"50%:50%の網タイル" の併用は、07/16 版へ戻した（この方が画質がいい）
			SC8 の タイルパターン生成のバグを修正。
	 07/23	SC5/7 のタイルパターン生成ルーチンを若干改善。
	 07/26	SC5/7 のタイルパターン生成ルーチンのバグを修正。
	 07/27	SC8 タイルパターン使用時の処理速度を改善。
			スクリプトウィンドウ（ファイル読み込みとテキスト編集のみ）を装備。
	 07/30	スクリプト内部処理を一部実装。
	 07/31	スクリプト命令「変換」「変換元ファイル名指定」「コメント」「設定の読み込み」を追加。
			存在しないファイル名・非対応のファイルを指定して変換すると途中経過表示ダイアログが表示
			されたままになる場合があるバグを修正。
	 08/02	スクリプト「出力画面モード設定」「各種フラグの設定」「メッセージボックスの表示」を追加。
	 08/03	スクリプトの機能を若干追加修正。
	 08/06	オリジナル画像表示ウィンドウのサイズを変更できるように修正（拡大縮小機能）。
			オリジナル画像表示ウィンドウに「等倍表示」「２倍表示」のメニューを追加。
			オリジナル画像表示ウィンドウの「スポイト」メニューを削除。常にスポイト状態に。
			サイズ調節機能で画像がぼやけてしまうバグを修正。
			スクリプトファイルの保存・新規作成（クリア）機能を追加。
			スクリプトに変換設定ダイアログ表示命令を追加。
			スクリプトの文字列処理・スペース読み飛ばし処理のバグを修正。
	 08/22	スクリプトにパレットの設定命令を追加。
			スクリプトにパレットのモード設定（指定・自動・未使用）命令を追加。
			スクリプトに切り捨て誤差設定命令を追加。
			スクリプトに誤差拡散係数設定命令を追加。
			スクリプトに選色モード設定命令を追加。
	 08/23	スクリプトにディザ加算設定命令を追加。
			スクリプトに自然画生成アルゴリズム設定命令を追加。
	 11/05	英語版の作成。
2001/02/13	自然画減色ルーチンの誤差訂正アルゴリズムで、青が弱いために輝度Ｙが絶対に最大にならない
			バグを修正（これで白が美しくなります）
	 03/08	自然画減色アルゴリズムの中の無用な四捨五入処理を排除（無意味な網がけが改善された）
	 03/09	プレビュー表示ルーチンのＹＪＫ→ＲＧＢ変換式を低精度に修正（実機に忠実にするため）
	 03/10	自然画減色処理アルゴリズムを一部見直し。Ｙ（輝度）の算出方法を修正して、輝度の再現性を
			高くした。
			誤差訂正アルゴリズムを「誤差訂正（輝度重視）」と「誤差訂正（色合い重視）」に分離。
			（輝度を重視すると、自然と青っぽくなってしまうため、用途により選択可能にした）
			色の誤差計算を手抜きをせずにしっかり計算するように修正。
			誤差訂正（輝度優先）の色比較において、Ｂ値をしかるべき値にクリップしてから比較するよう
			に修正。
			設定画面で、パレットを指定できない画面ではパレット表示を消す動作を追加
	 03/13	自然画減色アルゴリズムの修正により、輝度の再現性がいまいちであることをテスト画像を作成
			して確認。なめらかなグラデーションであっても、ある点から急激に輝度が明るくなることを発
			見。値のクリッピングにより発生している減少だと思われるが、「青っぽくなる現象」をおさえ
			つつ、これを解消する方法を模索せねばならない・・原因のみ判明。対策不明。
	 03/15	パレットモード MSX →Win の色変換テーブルを若干修正。
			自然画減色アルゴリズムの誤差拡散で、拡散した誤差を加えた値を元の値として使用しているバ
			グを修正
	 03/19	自然画減色処理ルーチンの最初のＪＫ計算が誤っていた（実際の値の１／８を採用していた）バ
			グを修正
			色の遠さを示す指標値の精度を１００倍まで増加
	 03/20	ヒストグラム作成関数の処理を若干高速化
	 03/25	自然画生成アルゴリズムでパワフル活用法方式を使うと黒くなる部分が白く化ける場合があるバ
			グを修正
			自然画生成アルゴリズムのどんな画像でも明らかに画質が悪くなるＮＴＳＣ方式を削除
			若干のコード修正
			自然画生成アルゴリズムのＹ値誤差拡散を微調整（不必要な網模様が出なくなりました）
	 03/26	昨日の改造で、自然画パワフル活用法アルゴリズムが壊れていたのを修正 (^_^;
			自然画アルゴリズムの誤差拡散の拡散する誤差が正負逆転していたバグを修正
			昨日の改造で、誤差拡散の影響でＹ値がラップラウンドしてしまうバグが混入していたのを修正
			自然画の誤差拡散で誤差が大きいとラップラウンドして画像を崩すバグを修正
			自然画の J,K 値をＭＳＸ向けの値に変換する式の精度を向上
	 03/31	自然画アルゴリズムの誤差拡散で、誤差を切り捨てた場合に誤差バッファを初期化しないバグを
			修正
	 04/01	日本語版と英語版のリソースファイル・プロジェクトファイルを分離
			色の遠さを求める式を 3/10 バージョン以前のモノに戻した（この方が高精度で高速）
			薄い網がけのディザパターンを高度な網がけパターンの 1/2 から 2/3 に修正
	 04/06	設定・再変換ダイアログにツールチップ（ポップアップする説明）を追加
	 04/07	設定・再変換ダイアログの OK ボタンの表示をそれぞれ「設定」「再変換」に変更
			バージョン番号を日付に関する数値に変更
	 04/13	SCREEN5/7 用パレットのソート機能を実装
	 04/14	プレビューの拡大表示機能を追加
			SCREEN6 出力を追加
			プレビューを 24bit BMP に保存する機能を追加
	 04/16	少し高速化
	 04/22	設定画面でパレットテーブルの縁に黒い線が現れ、他のウィンドウを重ねると重ねた部分だけ
			消える怪しげな現象を修正
			強制ゼロ化の色表示部分で上記同様の黒縁現象を修正
			パレットテーブルを左ドラッグすることでパレットを交換できる機能を追加
	 04/26	パレット交換カーソルのホットスポットがずれているのを修正
			設定・再変換画面でパレットの情報表示とパレットテーブルの表示が食い違うことがあるバグを
			修正
			「自動設定のみソート」のパレットソートで「設定値を使用」の色までソートされるバグを修正
			英語版のパレットテーブルを少し大きくした
			タイトル画面をクリックしても設定画面が開かないように修正
			タイトル画面をクリックすると画像を読み込んでいない旨を示すメッセージを追加
			設定画面に「再変換を常にデフォルトに採用」チェックを追加
			”設定画面”を”デフォルト設定”に名称変更
			再変換画面に「デフォルトへコピー」ボタンを追加
			英語版の設定画面でいくつかの表示が欠けていたのを修正
	 04/27	パレットの "自動決定のみソート" で強制終了するバグを修正
	 04/28	デフォルト設定を変更せずに再変換の設定を別の画像へ反映させる機能を追加
			（デフォルト設定画面の「変換設定」選択肢）
	 04/29	SCREEN3出力を追加
			SCREEN2出力を追加
			再変換画面に無意味な「変換時設定」の表示があったバグを修正
	 04/30	右クリックメニューを追加
			スクリプト命令の一部で無用な引数が必要だったバグを修正
			スクリプト命令 SCREEN で 4 が指定できないバグを修正
	 05/01	設定を読み込むたびに全てのコンボボックスの内容が増えていくバグを修正
			コンボボックスのリストのサイズをスクロールしなくて済むサイズに修正
			ＭＳＸ１のパレット色へ戻すボタンを追加
			"常に再変換をデフォルト化" や "デフォルトへコピー" を実行すると "常に再変換をデフォル
			ト化" の設定内容が破壊されるバグを修正
			MSX側モードのコンボボックスを操作するたびに設定画面がちらつく現象を修正
	 05/02	SCREEN2/3 でプレビューのＭＳＸ表示イメージと変換元画像表示が完全に重ならないバグを修正
			Susie PlugIn ("00IN" type) に対応
			設定画面にパレット保存ボタンを追加
			192ライン出力機能を追加
	 05/03	全固定パレットにチェックを入れていても「自動決定のみソート」が動作してしまうバグを修正
			設定ファイルの保存で拡張子が自由に設定できるバグを修正
			設定ファイルの保存で、ファイル名に拡張子 B2M を自動的に付加するように修正
			プレビューのＢＭＰ保存で、ファイル名に拡張子 CSV を自動的に付加するように修正
			パレットのＣＳＶ保存で、ファイル名に拡張子 CSV を自動的に付加するように修正
			パレットの読み込み・保存のダイアログで PL5/PL7 のフィルタがかかっていたのを PL? へ変更
	 05/04	SCREEN2〜7 のパレット決定アルゴリズムを若干改善
			SCREEN6 で無用なパレットは表示しないように修正
			Susie PlugIn による画像読み込みで、経過表示のプログレスバーを表示する機能を追加
	 05/06	Susie PlugIn で読み込むタイプの画像をドラッグ＆ドロップで開くと経過表示プログレスバー
			が表示されたままになるバグを修正
			一部のパレットを「設定値使用」にすると明るい色が自動生成のパレットに採用されなくなるバ
			グを修正
			昨日のパレット決定アルゴリズム改善部分のバグを修正
			バージョン表示ダイアログで表示が一部欠けていたバグを修正
			設定画面のパレット読み込みで BSAVE 画像についたパレットデータを読み込める機能を追加
			SCREEN5/6/7/8/10/12 出力モードと 192ラインモードを併用すると Win9x/Me で上下にゴミが出
			るバグを修正
			祝・一周年 (^_^;
	 05/07	多分布選色にチェックを入れると、"自動生成"パレットと"設定色を使用"のパレットが重複する
			場合があるバグを修正
	 05/08	１９２ラインモードと２１２ラインモードがあべこべになっている処理があったのを修正
			多分布選色で同じ色が発生する（5/6版よりも少ないけど）ことがあるバグを修正
	 05/09	プレビューを古い順から削除するように修正
	 05/10	プログラムに大幅な手を加えて拡張性を増強（まだ手を加えるべきところはたくさんある）
			経過表示ダイアログでファイル名をフルパスで表示していたのを、ファイル名のみに変更
			経過表示ダイアログを画面の中央へ寄せるように修正
			経過表示ダイアログでファイル名表示にワードラップ（単語の区切り目で自動的に改行する）が
			入っていたバグを修正（ "C:\Documents and Settings\HRA\My" だけしか表示されなかったりす
			る現象が治ってます。でもファイル名だけにしたからあまり意味無いかも。）
	 05/11	プラグインフォルダを指定する機能を追加
	 05/12	プラグインフォ留差の設定が正常に動作していなかったバグを修正
			サイズ調整機能の巨大画像縮小においてドット内基準位置をドット左上から中央へ変更
			サイズ調整機能で無用な部分まで計算対象に入れていたバグを修正（無用に画像がにじむ）
			サイズ調整を「ノーマル」「アンチエイリアス」の２種類に変更
			カーソルを重ねたときに表示される説明を少し追加
	 05/13	ＭＳＸ実機の表示でアスペクト比が崩れないように変換する機能を追加
			スポイト画面で、サンプル色をＭＳＸパレットで選べる色に変換した色を表示する機能を追加
			設定画面の各種コントロールを配置換え・・ちょっとはわかりやすくなったかな (^_^;
			パレットの「自動設定」「設定値を使用」の表示をアイコンに変更
	 05/14	「常にデフォルトへコピー」の動作が怪しかったバグを修正
			最初の起動時にデフォルト設定を変更してから変換しても、変更内容が反映されない場合があ
			るバグを修正
	 05/16	１枚ずつ新規の変換を行うと５０枚以上変換できないバグを修正
	 05/27	一通りテストをして問題が発生しなかったのでリリースバージョンへ更新
	 05/28	ヘルプメニューにヘルプファイルを開く項目を追加
	 06/22	32bit画像ファイルを正常に読み込めないバグを修正
			プレビューがあふれた際の自動削除対象が誤っていたバグを修正
	 07/14	ソースを若干整備、その際、ファイルが開けなかった判定に一部不備を発見 (^^; 修正。
	 07/21	インターレースON ＆ サイズ調節OFF の際に SC6出力と SC7出力 の出力サイズが異なるバグ
			を修正。
	 07/28	BSAVEヘッダの終了アドレスがおかしいバグを修正
	 10/08	パレット付き BSAVE において画像の下端からパレットの直前までの間にゴミが入るバグを修正
2005/02/05	SCREEN8 の青の出力レベルは、SCREEN5 の青の出力レベルを間引いたモノだという情報をいただ
			き、それにあわせて Convert.cpp の変換テーブル cb[] を修正。
			開発環境を VisualC++6.0 から VisualC++.NET2003 Pro へ変更。
			最適化オプションを見直し。
     02/11	In English version, a HOLD icon and a NO-USE icon revise a replaced bug.
			英語版において、HOLDアイコンとNOUSEアイコンが入れ替わっていたバグを修正。
2014/07/09	ビルド環境を VisualStudio express 2013 へ移行。
			Abs()関数の返値を明記していなかったバグを修正。
			リソースを微修正。
			256line出力モードを追加。
2022/07/17	ビルド環境を VisualStudio Community 2019 へ移行。
			インターレースモードで保存した場合に、1つのファイルが 100KBオーバーになるバグを修正。
	 07/24	カラーキャリブレーションダイアログ表示を追加。
	 		デフォルトの表示を2倍表示に変更。
	 		設定ダイアログを少し大きくした。
	 		メニューなどで半角カタカナを使用していたのを全角カタカナに変更。
			設定ファイルが無く、プラグインパスファイルがある場合に、プラグインパスファイルが読まれないバグを修正。
			BMP2MSX全体の設定を保存するファイル (BMP2MSX_CUSTOM.BIN)を追加。無ければ自動で作る。
	07/25	カラーキャリブレーションダイアログで初期値ロード→OKをクリックしないと、真っ黒に変換されるバグを修正。
